<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japanese N3 Vocabulary Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Mochiy+Pop+One&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation; /* Prevents double-tap zoom on mobile */
        }
        .card-container {
            perspective: 1000px;
        }
        .card {
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }
        .card.is-flipped {
            transform: rotateY(180deg);
        }
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .card-back {
            transform: rotateY(180deg);
        }
        .encouragement-popup {
            font-family: 'Mochiy Pop One', sans-serif;
            animation: fadeInOut 3s ease-in-out forwards;
        }
        @keyframes fadeInOut {
            0%, 100% { opacity: 0; transform: scale(0.9); }
            10%, 90% { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 flex items-center justify-center h-screen overflow-hidden">

    <div id="app" class="w-full max-w-md mx-auto h-full flex flex-col p-4">
        <!-- Stats Header -->
        <header class="mb-4 bg-white p-4 rounded-xl shadow-md">
            <h1 class="text-xl font-bold text-center text-slate-700 mb-3">Vocabulary Practice Stats</h1>
            <div class="grid grid-cols-3 gap-2 text-center">
                <div>
                    <div class="text-sm font-semibold text-slate-500">PERFECT</div>
                    <div id="perfect-score" class="text-2xl font-bold text-teal-500">0%</div>
                </div>
                <div>
                    <div class="text-sm font-semibold text-slate-500">LAST 100</div>
                    <div id="last100-score" class="text-2xl font-bold text-indigo-500">0</div>
                </div>
                <div>
                    <div class="text-sm font-semibold text-slate-500">MASTERED</div>
                    <div id="mastered-score" class="text-2xl font-bold text-amber-500">0</div>
                </div>
            </div>
        </header>

        <!-- Card -->
        <main class="card-container w-full flex-grow relative mb-4">
            <div id="card" class="card w-full h-full">
                <!-- Front of Card (Question) -->
                <div class="card-face card-front bg-white rounded-xl shadow-lg p-6 text-center">
                    <div class="text-sm text-slate-500 mb-4" id="question-type"></div>
                    <div class="text-3xl sm:text-4xl md:text-5xl font-bold" id="question-text"></div>
                </div>
                <!-- Back of Card (Answer) -->
                <div class="card-face card-back bg-white rounded-xl shadow-lg p-6 text-center">
                    <div id="answer-container">
                        <div class="mb-4">
                            <p class="text-sm text-slate-500">Cara Baca</p>
                            <p class="text-xl sm:text-2xl font-semibold text-sky-600" id="answer-cara-baca"></p>
                        </div>
                        <div>
                            <p class="text-sm text-slate-500">Arti</p>
                            <p class="text-xl sm:text-2xl font-semibold text-sky-600" id="answer-arti"></p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Action Buttons -->
        <footer>
            <!-- Question Buttons -->
            <div id="question-buttons" class="flex justify-around space-x-4">
                <button id="flip-button" class="w-full py-3 px-4 bg-blue-500 text-white font-bold rounded-lg shadow-md hover:bg-blue-600 transition-colors transform hover:scale-105">Show Answer</button>
                <button id="skip-button" class="w-full py-3 px-4 bg-slate-400 text-white font-bold rounded-lg shadow-md hover:bg-slate-500 transition-colors transform hover:scale-105">Skip</button>
            </div>
            <!-- Answer Buttons -->
            <div id="answer-buttons" class="hidden grid grid-cols-3 gap-2 md:gap-4">
                <button onclick="handleScore(-1)" class="text-sm sm:text-base py-3 px-2 sm:px-4 bg-red-500 text-white font-bold rounded-lg shadow-md hover:bg-red-600 transition-colors transform hover:scale-105">-1 (Forgot)</button>
                <button onclick="handleScore(0.5)" class="text-sm sm:text-base py-3 px-2 sm:px-4 bg-yellow-500 text-white font-bold rounded-lg shadow-md hover:bg-yellow-600 transition-colors transform hover:scale-105">+0.5 (Almost)</button>
                <button onclick="handleScore(1)" class="text-sm sm:text-base py-3 px-2 sm:px-4 bg-green-500 text-white font-bold rounded-lg shadow-md hover:bg-green-600 transition-colors transform hover:scale-105">+1 (Perfect)</button>
            </div>
        </footer>

        <!-- Encouragement Popup -->
        <div id="encouragement-popup" class="encouragement-popup hidden fixed inset-0 flex items-center justify-center pointer-events-none">
            <div class="bg-white p-8 rounded-full shadow-2xl text-3xl text-pink-500">
                <span id="encouragement-text"></span>
            </div>
        </div>
    </div>

    <script>
        const vocabularyData = [
            { kanji: 'æ„›æƒ…', kana: 'ã‚ã„ã˜ã‚‡ã†', caraBaca: 'aijoo', arti: 'Kasih sayang(rasa)' },
            { kanji: 'æ¡æ‰‹', kana: 'ã‚ãã—ã‚…', caraBaca: 'akusyu', arti: 'bersalaman' },
            { kanji: 'ã‚¢ã‚¯ã‚»ã‚¹', kana: '', caraBaca: 'akusesu', arti: 'akses' },
            { kanji: 'é›†ã¾ã‚Š', kana: 'ã‚ã¤ã¾ã‚Š', caraBaca: 'atsumari', arti: 'perkumpulan' },
            { kanji: 'å®›å', kana: 'ã‚ã¦ãª', caraBaca: 'atena', arti: 'alamat(tujuan)' },
            { kanji: 'å¾Œç‰‡ä»˜ã‘', kana: 'ã‚ã¨ã‹ãŸã¥ã‘', caraBaca: 'atokatadsuke', arti: 'beres2(setelah)' },
            { kanji: 'ã‚¢ãƒ‰ãƒã‚¤ã‚¹', kana: '', caraBaca: 'adobaisu', arti: 'saran' },
            { kanji: 'ç©´', kana: 'ã‚ãª', caraBaca: 'ana', arti: 'lubang' },
            { kanji: 'ä½™ã‚Š', kana: 'ã‚ã¾ã‚Š', caraBaca: 'amari', arti: 'sisa,berlebih' },
            { kanji: 'ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ', kana: '', caraBaca: 'ankeeto', arti: 'angket,survei' },
            { kanji: 'ã„ãŸãšã‚‰', kana: '', caraBaca: 'itazura', arti: 'nakal' },
            { kanji: 'ä¸€éƒ¨', kana: 'ã„ã¡ã¶', caraBaca: 'ichibu', arti: 'sebagian' },
            { kanji: 'ä¸€çž¬', kana: 'ã„ã£ã—ã‚…ã‚“', caraBaca: 'issyun', arti: 'sejenak,sekilas' },
            { kanji: 'é•å', kana: 'ã„ã¯ã‚“', caraBaca: 'ihan', arti: 'pelanggaran' },
            { kanji: 'ã‚¤ãƒ™ãƒ³ãƒˆ', kana: '', caraBaca: 'ibento', arti: 'acara,kegiatan' },
            { kanji: 'ã‚¤ãƒ¡ãƒ¼ã‚¸', kana: '', caraBaca: 'imeeji', arti: 'image,gambaran' },
            { kanji: 'å°åˆ·', kana: 'ã„ã‚“ã•ã¤', caraBaca: 'insatsu', arti: 'print' },
            { kanji: 'å°è±¡', kana: 'ã„ã‚“ã—ã‚‡ã†', caraBaca: 'insyoo', arti: 'kesan,berkesan' },
            { kanji: 'ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼', kana: '', caraBaca: 'intabyuu', arti: 'wawancara' },
            { kanji: 'å½±éŸ¿', kana: 'ãˆã„ãã‚‡ã†', caraBaca: 'eikyoo', arti: 'efek/pengaruh/dampak' },
            { kanji: 'å†…å´', kana: 'ã†ã¡ãŒã‚', caraBaca: 'uchigawa', arti: 'Bagian dalam' },
            { kanji: 'ã‚¨ã‚³', kana: '', caraBaca: 'eko', arti: 'Ramah lingkungan' },
            { kanji: 'å–¶æ¥­', kana: 'ãˆã„ãŽã‚‡ã†', caraBaca: 'eigyoo', arti: 'beroperasi' },
            { kanji: 'ã‚¨ãƒãƒ«ã‚®ãƒ¼', kana: '', caraBaca: 'enerugii', arti: 'energi' },
            { kanji: 'ã‚ªã‚¤ãƒ«', kana: '', caraBaca: 'oiru', arti: 'oil,minyak' },
            { kanji: 'ãŠç¥ã„', kana: 'ãŠã„ã‚ã„', caraBaca: 'oiwai', arti: 'perayaan' },
            { kanji: 'å¿œæ´', kana: 'ãŠã†ãˆã‚“', caraBaca: 'ooen', arti: 'mendukung' },
            { kanji: 'å¤§åž‹', kana: 'ãŠãŠãŒãŸ', caraBaca: 'oogata', arti: 'besar' },
            { kanji: 'ãŠã—ã‚ƒã¹ã‚Š', kana: '', caraBaca: 'osyaberi', arti: 'obrolan' },
            { kanji: 'è½ã¨ã—ç‰©', kana: 'ãŠã¨ã—ã‚‚ã®', caraBaca: 'otoshimono', arti: 'Brg hilang/jatuh' },
            { kanji: 'æ€ã„å‡º', kana: 'ãŠã‚‚ã„ã§', caraBaca: 'omoide', arti: 'kenangan' },
            { kanji: 'é–‹ä¼š', kana: 'ã‹ã„ã‹ã„', caraBaca: 'kaikai', arti: 'Pmbukaan prtemuan' },
            { kanji: 'è§£æ±º', kana: 'ã‹ã„ã‘ã¤', caraBaca: 'kaiketsu', arti: 'solusi/menyelesaikn' },
            { kanji: 'å¤–å‡º', kana: 'ãŒã„ã—ã‚…ã¤', caraBaca: 'gaisyutsu', arti: 'Pergi keluar' },
            { kanji: 'æ”¹æ­£', kana: 'ã‹ã„ã›ã„', caraBaca: 'kaisei', arti: 'revisi/amandemen' },
            { kanji: 'è§£èª¬', kana: 'ã‹ã„ã›ã¤', caraBaca: 'kaisetsu', arti: 'penjelasan' },
            { kanji: 'å›žè»¢', kana: 'ã‹ã„ã¦ã‚“', caraBaca: 'kaiten', arti: 'berputar,memutar/rotasi' },
            { kanji: 'æ›¸ç•™', kana: 'ã‹ãã¨ã‚', caraBaca: 'kakitome', arti: 'surat trcatat' },
            { kanji: 'æ‹¡å¤§', kana: 'ã‹ãã ã„', caraBaca: 'kakudai', arti: 'membesarkan(dizoom)' },
            { kanji: 'å®¶äº‹', kana: 'ã‹ã˜', caraBaca: 'kaji', arti: 'Pekerjaan rumah' },
            { kanji: 'è²¸ã—å‡ºã—', kana: 'ã‹ã—ã ã—', caraBaca: 'kashidashi', arti: 'peminjaman' },
            { kanji: 'æ•°', kana: 'ã‹ãš', caraBaca: 'kazu', arti: 'jumlah' },
            { kanji: 'åž‹', kana: 'ã‹ãŸ', caraBaca: 'kata', arti: 'model,tipe' },
            { kanji: 'ç‰‡æ–¹', kana: 'ã‹ãŸã»ã†', caraBaca: 'katahou', arti: 'Salah satu,satu sisi' },
            { kanji: 'ã‚«ã‚¿ãƒ­ã‚°', kana: '', caraBaca: 'katarogu', arti: 'katalog' },
            { kanji: 'ä¾¡å€¤', kana: 'ã‹ã¡', caraBaca: 'kachi', arti: 'nilai' },
            { kanji: 'ã‚«ãƒƒãƒˆ', kana: '', caraBaca: 'katto', arti: 'cut,potong' },
            { kanji: 'æ´»å‹•', kana: 'ã‹ã¤ã©ã†', caraBaca: 'katsudoo', arti: 'aktifitas,aksi' },
            { kanji: 'æˆ‘æ…¢', kana: 'ãŒã¾ã‚“', caraBaca: 'gaman', arti: 'sabar,menahan' },
            { kanji: 'ç©º', kana: 'ã‹ã‚‰', caraBaca: 'kara', arti: 'kosong' },
            { kanji: 'é©', kana: 'ã‹ã‚', caraBaca: 'kawa', arti: 'kulit' },
            { kanji: 'æ­“è¿Ž', kana: 'ã‹ã‚“ã’ã„', caraBaca: 'kangei', arti: 'menyambut' },
            { kanji: 'è¦³å…‰', kana: 'ã‹ã‚“ã“ã†', caraBaca: 'kankoo', arti: 'berwisata' },
            { kanji: 'è¦³å¯Ÿ', kana: 'ã‹ã‚“ã•ã¤', caraBaca: 'kansatsu', arti: 'pengamatan' },
            { kanji: 'æ„Ÿã˜', kana: 'ã‹ã‚“ã˜', caraBaca: 'kanji', arti: 'perasaan,kesan' },
            { kanji: 'æ„Ÿè¬', kana: 'ã‹ã‚“ã—ã‚ƒ', caraBaca: 'kansya', arti: 'Berterima kasih' },
            { kanji: 'æ„Ÿæƒ…', kana: 'ã‹ã‚“ã˜ã‚‡ã†', caraBaca: 'kanjoo', arti: 'perasaan,emosi' },
            { kanji: 'é–¢å¿ƒ', kana: 'ã‹ã‚“ã—ã‚“', caraBaca: 'kanshin', arti: 'minat' },
            { kanji: 'æ„Ÿå¿ƒ', kana: 'ã‹ã‚“ã—ã‚“', caraBaca: 'kanshin', arti: 'berkesan' },
            { kanji: 'å®Œæˆ', kana: 'ã‹ã‚“ã›ã„', caraBaca: 'kansei', arti: 'selesai,lengkap' },
            { kanji: 'æ„Ÿæƒ³', kana: 'ã‹ã‚“ãã†', caraBaca: 'kansoo', arti: 'kesan,berkesan' },
            { kanji: 'æ„Ÿå‹•', kana: 'ã‹ã‚“ã©ã†', caraBaca: 'kandoo', arti: 'terharu' },
            { kanji: 'ä¹¾æ¯', kana: 'ã‹ã‚“ã±ã„', caraBaca: 'kanpai', arti: 'bersulang' },
            { kanji: 'ç®¡ç†', kana: 'ã‹ã‚“ã‚Š', caraBaca: 'kanri', arti: 'manajemen' },
            { kanji: 'é–¢é€£', kana: 'ã‹ã‚“ã‚Œã‚“', caraBaca: 'kanren', arti: 'hubungan/relasi' },
            { kanji: 'æ©Ÿä¼š', kana: 'ãã‹ã„', caraBaca: 'kikai', arti: 'kesempatan' },
            { kanji: 'åŠ¹ãã‚', kana: 'ããã‚', caraBaca: 'kikime', arti: 'keefektifan' },
            { kanji: 'å¸°å›½', kana: 'ãã“ã', caraBaca: 'kikoku', arti: 'Pulang ke negara' },
            { kanji: 'è¨˜äº‹', kana: 'ãã˜', caraBaca: 'kiji', arti: 'artikel' },
            { kanji: 'æŠ€è¡“', kana: 'ãŽã˜ã‚…ã¤', caraBaca: 'gijutsu', arti: 'teknologi' },
            { kanji: 'æœŸå¾…', kana: 'ããŸã„', caraBaca: 'kitai', arti: 'harapan' },
            { kanji: 'å¸°å®…', kana: 'ããŸã', caraBaca: 'kitaku', arti: 'Pulang ke rumah' },
            { kanji: 'è²´é‡å“', kana: 'ãã¡ã‚‡ã†ã²ã‚“', caraBaca: 'kichoohin', arti: 'Barang berharga' },
            { kanji: 'è¨˜å…¥', kana: 'ãã«ã‚…ã†', caraBaca: 'kinyuu', arti: 'mengisi' },
            { kanji: 'è¨˜å¿µ', kana: 'ãã­ã‚“', caraBaca: 'kinen', arti: 'mengenang' },
            { kanji: 'å¸Œæœ›', kana: 'ãã¼ã†', caraBaca: 'kiboo', arti: 'berharap/harapan' },
            { kanji: 'åŸºæœ¬', kana: 'ãã»ã‚“', caraBaca: 'kihon', arti: 'dasar' },
            { kanji: 'ç¾©å‹™', kana: 'ãŽã‚€', caraBaca: 'gimu', arti: 'kewajiban' },
            { kanji: 'ç–‘å•', kana: 'ãŽã‚‚ã‚“', caraBaca: 'gimon', arti: 'pertanyaan/ragu(dlm pikiran)' },
            { kanji: 'ä¼‘æ†©', kana: 'ãã‚…ã†ã‘ã„', caraBaca: 'kyuukei', arti: 'istirahat' },
            { kanji: 'æ€¥ç”¨', kana: 'ãã‚…ã†ã‚ˆã†', caraBaca: 'kyuuyoo', arti: 'Keperluan bisnis/mendesak' },
            { kanji: 'è¡Œäº‹', kana: 'ãŽã‚‡ã†ã˜', caraBaca: 'gyooji', arti: 'acara/even' },
            { kanji: 'ç«¶äº‰', kana: 'ãã‚‡ã†ãã†', caraBaca: 'kyoosoo', arti: 'kompetisi' },
            { kanji: 'å…±é€š', kana: 'ãã‚‡ã†ã¤ã†', caraBaca: 'kyootsuu', arti: 'sama/memiliki kesamaan' },
            { kanji: 'å”åŠ›', kana: 'ãã‚‡ã†ã‚Šã‚‡ã', caraBaca: 'kyooryoku', arti: 'Kerjasama' },
            { kanji: 'è¡Œåˆ—', kana: 'ãŽã‚‡ã†ã‚Œã¤', caraBaca: 'gyooretsu', arti: 'antrian' },
            { kanji: 'è¨±å¯', kana: 'ãã‚‡ã‹', caraBaca: 'kyoka', arti: 'izin' },
            { kanji: 'æ¼æ¥­', kana: 'ãŽã‚‡ãŽã‚‡ã†', caraBaca: 'gyogyoo', arti: 'Industri prikanan' },
            { kanji: 'è·é›¢', kana: 'ãã‚‡ã‚Š', caraBaca: 'kyori', arti: 'jarak' },
            { kanji: 'è¨˜éŒ²', kana: 'ãã‚ã', caraBaca: 'kiroku', arti: 'merekam(di data)' },
            { kanji: 'é‡‘åº«', kana: 'ãã‚“ã“', caraBaca: 'kinko', arti: 'brangkas' },
            { kanji: 'è¿‘è¦–', kana: 'ãã‚“ã—', caraBaca: 'kinshi', arti: 'Rabun jauh' },
            { kanji: 'ç·Šå¼µ', kana: 'ãã‚“ã¡ã‚‡ã†', caraBaca: 'kinchoo', arti: 'gerogi' },
            { kanji: 'å…·åˆ', kana: 'ãã‚ã„', caraBaca: 'guai', arti: 'kondisi' },
            { kanji: 'å·¥å¤«', kana: 'ããµã†', caraBaca: 'kufuu', arti: 'Mencari cara' },
            { kanji: 'åŒºåˆ¥', kana: 'ãã¹ã¤', caraBaca: 'kubetsu', arti: 'membedakan' },
            { kanji: 'ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°', kana: '', caraBaca: 'kuriiningu', arti: 'laundry' },
            { kanji: 'è‹¦åŠ´', kana: 'ãã‚ã†', caraBaca: 'kuroo', arti: 'kesulitan' },
            { kanji: 'çµŒå–¶', kana: 'ã‘ã„ãˆã„', caraBaca: 'keiei', arti: 'mengelola' },
            { kanji: 'æŽ²ç¤º', kana: 'ã‘ã„ã˜', caraBaca: 'keiji', arti: 'trpajang/memajang' },
            { kanji: 'æ™¯è‰²', kana: 'ã‘ã—ã', caraBaca: 'keshiki', arti: 'pemandangan' },
            { kanji: 'çµæžœ', kana: 'ã‘ã£ã‹', caraBaca: 'kekka', arti: 'hasil' },
            { kanji: 'æ±ºå¿ƒ', kana: 'ã‘ã£ã—ã‚“', caraBaca: 'kesshin', arti: 'Keputusan bulat' },
            { kanji: 'æ¬ å¸­', kana: 'ã‘ã£ã›ã', caraBaca: 'kesseki', arti: 'Tdk hadir' },
            { kanji: 'æ±ºå®š', kana: 'ã‘ã£ã¦ã„', caraBaca: 'kettei', arti: 'keputusan' },
            { kanji: 'æ¬ ç‚¹', kana: 'ã‘ã£ã¦ã‚“', caraBaca: 'ketten', arti: 'kekurangan' },
            { kanji: 'çµè«–', kana: 'ã‘ã¤ã‚ã‚“', caraBaca: 'ketsuron', arti: 'kesimpulan' },
            { kanji: 'åˆ¸', kana: 'ã‘ã‚“', caraBaca: 'ken', arti: 'tiket' }, // Changed from tikus
            { kanji: 'ç ”ä¿®', kana: 'ã‘ã‚“ã—ã‚…ã†', caraBaca: 'kensyuu', arti: 'pelatihan' },
            { kanji: 'å»ºè¨­', kana: 'ã‘ã‚“ã›ã¤', caraBaca: 'kensetsu', arti: 'konstruksi' }, // Changed from instruksi
            { kanji: 'å»ºç¯‰', kana: 'ã‘ã‚“ã¡ã', caraBaca: 'kenchiku', arti: 'arsitek' },
            { kanji: 'æ¨©åˆ©', kana: 'ã‘ã‚“ã‚Š', caraBaca: 'kenri', arti: 'hak' },
            { kanji: 'åŽŸæ–™', kana: 'ã’ã‚“ã‚Šã‚‡ã†', caraBaca: 'genryoo', arti: 'Bahan dasar' },
            { kanji: 'è¬›æ¼”', kana: 'ã“ã†ãˆã‚“', caraBaca: 'kooen', arti: 'perkuliahan' },
            { kanji: 'åŠ¹æžœ', kana: 'ã“ã†ã‹', caraBaca: 'kooka', arti: 'efek(baik)' },
            { kanji: 'äº¤æ›', kana: 'ã“ã†ã‹ã‚“', caraBaca: 'kookan', arti: 'bertukar' },
            { kanji: 'å·¥æ¥­', kana: 'ã“ã†ãŽã‚‡ã†', caraBaca: 'koogyoo', arti: 'industri' },
            { kanji: 'èˆªç©ºä¾¿', kana: 'ã“ã†ãã†ã³ã‚“', caraBaca: 'kookuubin', arti: 'Pos udara' },
            { kanji: 'åˆè¨ˆ', kana: 'ã”ã†ã‘ã„', caraBaca: 'gookei', arti: 'total' },
            { kanji: 'åºƒå‘Š', kana: 'ã“ã†ã“ã', caraBaca: 'kookoku', arti: 'iklan' },
            { kanji: 'äº¤éš›', kana: 'ã“ã†ã•ã„', caraBaca: 'kosai', arti: 'hubungan' },
            { kanji: 'å·¥äº‹', kana: 'ã“ã†ã˜', caraBaca: 'kooji', arti: 'Pngerjaan konstruksi' },
            { kanji: 'è¡Œå‹•', kana: 'ã“ã†ã©ã†', caraBaca: 'koodoo', arti: 'brbuat/bertindak' },
            { kanji: 'å…¬ç«‹', kana: 'ã“ã†ã‚Šã¤', caraBaca: 'kooritsu', arti: 'umum' },
            { kanji: 'äº¤æµ', kana: 'ã“ã†ã‚Šã‚…ã†', caraBaca: 'kooryuu', arti: 'brinteraksi' },
            { kanji: 'ã‚³ãƒ¼ã‚¹', kana: '', caraBaca: 'koosu', arti: 'lintasan,jalur' },
            { kanji: 'ã‚³ãƒ¼ãƒŠãƒ¼', kana: '', caraBaca: 'koonaa', arti: 'korner,area' },
            { kanji: 'ã‚´ãƒ¼ãƒ«', kana: '', caraBaca: 'gooru', arti: 'tujuan,target' },
            { kanji: 'èª¤è§£', kana: 'ã”ã‹ã„', caraBaca: 'gokai', arti: 'Salah paham' },
            { kanji: 'å°åž‹', kana: 'ã“ãŒãŸ', caraBaca: 'kogata', arti: 'Ukuran kecil' },
            { kanji: 'å›½ç”£', kana: 'ã“ãã•ã‚“', caraBaca: 'kokusan', arti: 'Produksi dlm negri' },
            { kanji: 'å›½ç«‹', kana: 'ã“ãã‚Šã¤', caraBaca: 'kokuritsu', arti: 'negeri' },
            { kanji: 'æ•…éšœ', kana: 'ã“ã—ã‚‡ã†', caraBaca: 'kosyoo', arti: 'rusak' },
            { kanji: 'å›½ä¼š', kana: 'ã“ã£ã‹ã„', caraBaca: 'kokkai', arti: 'parlemen' },
            { kanji: 'å°åŒ…', kana: 'ã“ã¥ã¤ã¿', caraBaca: 'kodutsumi', arti: 'paket' },
            { kanji: 'ç²‰', kana: 'ã“ãª', caraBaca: 'kona', arti: 'tepung' },
            { kanji: 'ã‚³ãƒ³ã‚¯ãƒ¼ãƒ«', kana: '', caraBaca: 'konkuuru', arti: 'kontes' },
            { kanji: 'æœ€é«˜', kana: 'ã•ã„ã“ã†', caraBaca: 'saikoo', arti: 'Paling tinggi' },
            { kanji: 'æœ€å¤§', kana: 'ã•ã„ã ã„', caraBaca: 'saidai', arti: 'Paling besar' },
            { kanji: 'æœ€ä½Ž', kana: 'ã•ã„ã¦ã„', caraBaca: 'saitei', arti: 'Paling rendah' },
            { kanji: 'è£åˆ¤', kana: 'ã•ã„ã°ã‚“', caraBaca: 'saiban', arti: 'pengadilan' },
            { kanji: 'ææ–™', kana: 'ã–ã„ã‚Šã‚‡ã†', caraBaca: 'zairyoo', arti: 'bahan,material' },
            { kanji: 'ã‚µã‚¤ãƒ¬ãƒ³', kana: '', caraBaca: 'sairen', arti: 'Bunyi sirene' },
            { kanji: 'ä½œæ¥­', kana: 'ã•ãŽã‚‡ã†', caraBaca: 'sagyoo', arti: 'pengerjaan' },
            { kanji: 'ä½œå“', kana: 'ã•ãã²ã‚“', caraBaca: 'sakuhin', arti: 'Hasil karya' },
            { kanji: 'æ’®å½±', kana: 'ã•ã¤ãˆã„', caraBaca: 'satsuei', arti: 'Pengambilan foto/video' },
            { kanji: 'é¨’ãŽ', kana: 'ã•ã‚ãŽ', caraBaca: 'sawagi', arti: 'keributan' },
            { kanji: 'å‚åŠ ', kana: 'ã•ã‚“ã‹', caraBaca: 'sanka', arti: 'ikut,brpartipasi' },
            { kanji: 'ç”£æ¥­', kana: 'ã•ã‚“ãŽã‚‡ã†', caraBaca: 'sangyoo', arti: 'industri' },
            { kanji: 'å‚è€ƒ', kana: 'ã•ã‚“ã“ã†', caraBaca: 'sankoo', arti: 'referensi' },
            { kanji: 'è³›æˆ', kana: 'ã•ã‚“ã›ã„', caraBaca: 'sansei', arti: 'setuju,sepakat' }, // Changed from sepaket
            { kanji: 'ç”£åœ°', kana: 'ã•ã‚“ã¡', caraBaca: 'sanchi', arti: 'Lokasi produksi' },
            { kanji: 'æ®‹æ¥­', kana: 'ã–ã‚“ãŽã‚‡ã†', caraBaca: 'zangyoo', arti: 'lembur' },
            { kanji: 'è³‡æº', kana: 'ã—ã’ã‚“', caraBaca: 'shigen', arti: 'Sumber alam' },
            { kanji: 'äº‹ä»¶', kana: 'ã˜ã‘ã‚“', caraBaca: 'jiken', arti: 'insiden' },
            { kanji: 'è«¦ã‚ã‚‹', kana: 'ã‚ãã‚‰ã‚ã‚‹', caraBaca: 'akirameru', arti: 'menyerah' },
            { kanji: 'é£½ãã‚‹', kana: 'ã‚ãã‚‹', caraBaca: 'akiru', arti: 'jenuh' },
            { kanji: 'é ã‹ã‚‹', kana: 'ã‚ãšã‹ã‚‹', caraBaca: 'azukaru', arti: 'dititipkan' },
            { kanji: 'é ã‘ã‚‹', kana: 'ã‚ãšã‘ã‚‹', caraBaca: 'azukeru', arti: 'menitipkan' },
            { kanji: 'æš–ã‚ã‚‹', kana: 'ã‚ãŸãŸã‚ã‚‹', caraBaca: 'atatameru', arti: 'menghangatkan (suhu udara)' },
            { kanji: 'æ¸©ã‚ã‚‹', kana: 'ã‚ãŸãŸã‚ã‚‹', caraBaca: 'atatameru', arti: 'menghangatkan (benda)' },
            { kanji: 'å½“ãŸã‚‹', kana: 'ã‚ãŸã‚‹', caraBaca: 'ataru', arti: 'terkena' },
            { kanji: 'ä½™ã‚‹', kana: 'ã‚ã¾ã‚‹', caraBaca: 'amaru', arti: 'berlebih' },
            { kanji: 'ç·¨ã‚€', kana: 'ã‚ã‚€', caraBaca: 'amu', arti: 'merajut' },
            { kanji: 'ç¾ã‚Œã‚‹', kana: 'ã‚ã‚‰ã‚ã‚Œã‚‹', caraBaca: 'arawareru', arti: 'muncul' }, // Corrected spelling
            { kanji: 'åˆã‚ã›ã‚‹', kana: 'ã‚ã‚ã›ã‚‹', caraBaca: 'awaseru', arti: 'mencocokkan' },
            { kanji: 'æ…Œã¦ã‚‹', kana: 'ã‚ã‚ã¦ã‚‹', caraBaca: 'awateru', arti: 'tergesa2' },
            { kanji: 'ç”Ÿã‹ã™', kana: 'ã„ã‹ã™', caraBaca: 'ikasu', arti: 'menerapkan' },
            { kanji: 'ã„ã˜ã‚ã‚‹', kana: '', caraBaca: 'ijimeru', arti: 'membully' },
            { kanji: 'ç‚’ã‚ã‚‹', kana: 'ã„ãŸã‚ã‚‹', caraBaca: 'itameru', arti: 'menumis' }, // Added kanji
            { kanji: 'å«ŒãŒã‚‹', kana: 'ã„ã‚„ãŒã‚‹', caraBaca: 'iyagaru', arti: 'membenci' },
            { kanji: 'ã„ã‚‰ã„ã‚‰ã™ã‚‹', kana: '', caraBaca: 'irairasuru', arti: 'meradang,marah' },
            { kanji: 'ç¥ã†', kana: 'ã„ã‚ã†', caraBaca: 'iwau', arti: 'merayakan' },
            { kanji: 'æµ…ã„', kana: 'ã‚ã•ã„', caraBaca: 'asai', arti: 'dangkal' },
            { kanji: 'æã‚ã—ã„', kana: 'ãŠãã‚ã—ã„', caraBaca: 'osoroshii', arti: 'menakutkan' },
            { kanji: 'ãŠã¨ãªã—ã„', kana: '', caraBaca: 'otonashii', arti: 'manut,pendiam' },
            { kanji: 'ã‹ã‚†ã„', kana: '', caraBaca: 'kayui', arti: 'gatal' },
            { kanji: 'ãã¤ã„', kana: '', caraBaca: 'kitsui', arti: 'sempit' },
            { kanji: 'æ‚”ã—ã„', kana: 'ãã‚„ã—ã„', caraBaca: 'kuyashii', arti: 'kecewa' },
            { kanji: 'æŒ‡ç¤º', kana: 'ã—ã˜', caraBaca: 'shiji', arti: 'instruksi,arahan' },
            { kanji: 'äº‹å®Ÿ', kana: 'ã˜ã˜ã¤', caraBaca: 'jijitsu', arti: 'kenyataan,fakta' },
            { kanji: 'äº‹æƒ…', kana: 'ã˜ã˜ã‚‡ã†', caraBaca: 'jijyoo', arti: 'situasi,kondisi' },
            { kanji: 'è‡ªä¿¡', kana: 'ã˜ã—ã‚“', caraBaca: 'jishin', arti: 'Percaya diri' },
            { kanji: 'æ™‚é€Ÿ', kana: 'ã˜ãã', caraBaca: 'jisoku', arti: 'Kecepatan perjam' },
            { kanji: 'æ”¯åº¦', kana: 'ã—ãŸã', caraBaca: 'shitaku', arti: 'persiapan' },
            { kanji: 'å¤±æ¥­', kana: 'ã—ã¤ãŽã‚‡ã†', caraBaca: 'shitsugyoo', arti: 'Kehilangan pekerjaan' },
            { kanji: 'å®Ÿéš›', kana: 'ã˜ã£ã•ã„', caraBaca: 'jissai', arti: 'Yang sebenarnya' },
            { kanji: 'å®ŸåŠ›', kana: 'ã˜ã¤ã‚Šã‚‡ã', caraBaca: 'jitsuryoku', arti: 'kekuatan' },
            { kanji: 'æ”¯åº—', kana: 'ã—ã¦ã‚“', caraBaca: 'shiten', arti: 'Toko cabang' },
            { kanji: 'æŒ‡å°Ž', kana: 'ã—ã©ã†', caraBaca: 'shidoo', arti: 'membimbing' },
            { kanji: 'äº‹å‹™', kana: 'ã˜ã‚€', caraBaca: 'jimu', arti: 'Kerjaan kantor' },
            { kanji: 'ç· ã‚åˆ‡ã‚Š', kana: 'ã—ã‚ãã‚Š', caraBaca: 'shimekiri', arti: 'Batas waktu' },
            { kanji: 'ã˜ã‚ƒã¾', kana: '', caraBaca: 'jama', arti: 'gangguan' },
            { kanji: 'é›†ä¼š', kana: 'ã—ã‚…ã†ã‹ã„', caraBaca: 'syuukai', arti: 'pertemuan' },
            { kanji: 'å®—æ•™', kana: 'ã—ã‚…ã†ãã‚‡ã†', caraBaca: 'syuukyoo', arti: 'agama' },
            { kanji: 'é›†åˆ', kana: 'ã—ã‚…ã†ã”ã†', caraBaca: 'syuugoo', arti: 'kumpul' },
            { kanji: 'å°±è·', kana: 'ã—ã‚…ã†ã—ã‚‡ã', caraBaca: 'syuusyoku', arti: 'pekerjaan' },
            { kanji: 'é›†ä¸­', kana: 'ã—ã‚…ã†ã¡ã‚…ã†', caraBaca: 'syuuchuu', arti: 'fokus' },
            { kanji: 'å……é›»', kana: 'ã˜ã‚…ã†ã§ã‚“', caraBaca: 'juuden', arti: 'mengisi(baterai)' },
            { kanji: 'ä¿®ç†', kana: 'ã—ã‚…ã†ã‚Š', caraBaca: 'syuuri', arti: 'perbaikan' },
            { kanji: 'ä¸»ç¾©', kana: 'ã—ã‚…ãŽ', caraBaca: 'syugi', arti: 'komitmen/prinsip' },
            { kanji: 'ç¸®å°', kana: 'ã—ã‚…ãã—ã‚‡ã†', caraBaca: 'syukusyoo', arti: 'mengurangi' },
            { kanji: 'å—ä¿¡', kana: 'ã˜ã‚…ã—ã‚“', caraBaca: 'jushin', arti: 'menerima(email,pesan)' },
            { kanji: 'æ¤ãˆã‚‹', kana: 'ã†ãˆã‚‹', caraBaca: 'ueru', arti: 'menanam' },
            { kanji: 'å—ã‹ã‚‹', kana: 'ã†ã‹ã‚‹', caraBaca: 'ukaru', arti: 'lulus' },
            { kanji: 'æµ®ã', kana: 'ã†ã', caraBaca: 'uku', arti: 'mengambang' },
            { kanji: 'å—ã‘ä»˜ã‘ã‚‹', kana: 'ã†ã‘ã¤ã‘ã‚‹', caraBaca: 'uketsukeru', arti: 'menerima' },
            { kanji: 'å—ã‘å–ã‚‹', kana: 'ã†ã‘ã¨ã‚‹', caraBaca: 'uketoru', arti: 'menerima' },
            { kanji: 'å‹•ã‹ã™', kana: 'ã†ã”ã‹ã™', caraBaca: 'ugokasu', arti: 'menggerakkan/memindahkan' },
            { kanji: 'ç§»ã™', kana: 'ã†ã¤ã™', caraBaca: 'utsusu', arti: 'memindahkan(hal abstrak jg trmasuk)' },
            { kanji: 'å†™ã‚‹', kana: 'ã†ã¤ã‚‹', caraBaca: 'utsuru', arti: 'terfoto' },
            { kanji: 'è£è¿”ã™', kana: 'ã†ã‚‰ãŒãˆã™', caraBaca: 'uragaesu', arti: 'membalikkan' },
            { kanji: 'å£²ã‚Šåˆ‡ã‚Œã‚‹', kana: 'ã†ã‚Šãã‚Œã‚‹', caraBaca: 'urikireru', arti: 'Habis terjual' },
            { kanji: 'è¿½ã„æŽ›ã‘ã‚‹', kana: 'ãŠã„ã‹ã‘ã‚‹', caraBaca: 'oikakeru', arti: 'mengejar' },
            { kanji: 'è¿½ã„è¶Šã™', kana: 'ãŠã„ã“ã™', caraBaca: 'oikosu', arti: 'menyusul,menyalip' },
            { kanji: 'è¿½ã„ä»˜ã', kana: 'ãŠã„ã¤ã', caraBaca: 'oitsuku', arti: 'menyusul' },
            { kanji: 'è´ˆã‚‹', kana: 'ãŠãã‚‹', caraBaca: 'okuru', arti: 'Mengirim hadiah' },
            { kanji: 'è¡Œã†', kana: 'ãŠã“ãªã†', caraBaca: 'okonau', arti: 'mengadakan' },
            { kanji: 'æŠ¼ã•ãˆã‚‹', kana: 'ãŠã•ãˆã‚‹', caraBaca: 'osaeru', arti: 'memegang,menahan' },
            { kanji: 'è½ã¡ç€ã', kana: 'ãŠã¡ã¤ã', caraBaca: 'ochitsuku', arti: 'tenang' },
            { kanji: 'æººã‚Œã‚‹', kana: 'ãŠã¼ã‚Œã‚‹', caraBaca: 'oboreru', arti: 'tenggelam(kecelakaan)' },
            { kanji: 'æ€ã„ä»˜ã', kana: 'ãŠã‚‚ã„ã¤ã', caraBaca: 'oitsuku', arti: 'Muncul ide' }, // Changed kanji to match meaning
            { kanji: 'æŠ˜ã‚Œã‚‹', kana: 'ãŠã‚Œã‚‹', caraBaca: 'oreru', arti: 'patah' },
            { kanji: 'ä¸‹ã‚ã™', kana: 'ãŠã‚ã™', caraBaca: 'orosu', arti: 'menurunkan' },
            { kanji: 'é£¼ã†', kana: 'ã‹ã†', caraBaca: 'kau', arti: 'memelihara' },
            { kanji: 'è¼ã', kana: 'ã‹ãŒã‚„ã', caraBaca: 'kagayaku', arti: 'bersinar(abstrakpun bisa)' },
            { kanji: 'éš ã™', kana: 'ã‹ãã™', caraBaca: 'kakusu', arti: 'menyembunyikan' },
            { kanji: 'è‹¦ã—ã„', kana: 'ãã‚‹ã—ã„', caraBaca: 'kurushii', arti: 'menderita,kesusahan' },
            { kanji: 'è©³ã—ã„', kana: 'ãã‚ã—ã„', caraBaca: 'kuwashii', arti: 'detail' },
            { kanji: 'æ¿ƒã„', kana: 'ã“ã„', caraBaca: 'koi', arti: 'pekat,kental(warna,rasa mknnan)' },
            { kanji: 'ç´°ã‹ã„', kana: 'ã“ã¾ã‹ã„', caraBaca: 'komakai', arti: 'kecil' },
            { kanji: 'å¡©è¾›ã„', kana: 'ã—ãŠã‹ã‚‰ã„', caraBaca: 'shiokarai', arti: 'asin' },
            { kanji: 'å››è§’ã„', kana: 'ã—ã‹ãã„', caraBaca: 'shikakui', arti: 'Persegi empat' },
            { kanji: 'ã¤ã‚‰ã„', kana: '', caraBaca: 'tsurai', arti: 'berat,menyakitkan' },
            { kanji: 'ã¬ã‚‹ã„', kana: '', caraBaca: 'nurui', arti: 'hangat(air,cairan)' },
            { kanji: 'è²§ã—ã„', kana: 'ã¾ãšã—ã„', caraBaca: 'mazushii', arti: 'miskin' },
            { kanji: 'è’¸ã—æš‘ã„', kana: 'ã‚€ã—ã‚ã¤ã„', caraBaca: 'mushiatsui', arti: 'Panas gerah' },
            { kanji: 'ã‚‚ã£ãŸã„ãªã„', kana: '', caraBaca: 'mottainai', arti: 'mubazir,sia2' },
            { kanji: 'ã‚‚ã®ã™ã”ã„', kana: '', caraBaca: 'monosugoi', arti: 'Luar biasa' }
        ];

        const encouragementMessages = [
            "You're doing great! âœ¨", "Awesome! ðŸ‘", "Keep it up! ðŸš€", "Super smart! ðŸ§ ",
            "Wow! ðŸŽ‰", "You're a star! â­", "Fantastic! ðŸ˜ƒ", "Brilliant! ðŸ’¡"
        ];

        let words = [];
        let currentWordIndex = -1;
        let last100Scores = [];
        let perfectCount = 0;
        let questionsAnswered = 0;
        let questionCounter = 0;

        // DOM Elements
        const card = document.getElementById('card');
        const questionText = document.getElementById('question-text');
        const questionType = document.getElementById('question-type');
        const answerCaraBaca = document.getElementById('answer-cara-baca');
        const answerArti = document.getElementById('answer-arti');
        const questionButtons = document.getElementById('question-buttons');
        const answerButtons = document.getElementById('answer-buttons');
        const flipButton = document.getElementById('flip-button');
        const skipButton = document.getElementById('skip-button');
        
        // --- Initialization ---
        function init() {
            words = vocabularyData.map((word, index) => ({
                ...word,
                id: index,
                history: [], // Stores last 5 scores
                mastery: 0, // 0: new, 1: learning, 2: mastered
            }));
            
            flipButton.addEventListener('click', flipCard);
            skipButton.addEventListener('click', () => handleScore(0));

            nextQuestion();
        }

        // --- Core Logic ---
        function nextQuestion() {
            if (card.classList.contains('is-flipped')) {
                card.classList.remove('is-flipped');
            }
            
            // Short delay to allow flip-back animation to start
            setTimeout(() => {
                currentWordIndex = chooseNextWordIndex();
                displayQuestion();
                
                questionButtons.classList.remove('hidden');
                questionButtons.classList.add('flex');
                answerButtons.classList.add('hidden');
            }, 200);
        }

        function chooseNextWordIndex() {
            const notMastered = words.filter(w => w.mastery < 2);
            const mastered = words.filter(w => w.mastery === 2);

            // Create a weighted pool of words
            // Not-mastered words are 4 times more likely to appear
            // This encourages practice on difficult words but still provides positive feedback
            let weightedPool = [];
            notMastered.forEach(word => {
                for(let i=0; i < 4; i++) weightedPool.push(word.id);
            });
            mastered.forEach(word => weightedPool.push(word.id));
            
            if (weightedPool.length === 0) { // All words mastered
                weightedPool = words.map(w => w.id);
            }
            
            const randomIndex = Math.floor(Math.random() * weightedPool.length);
            return weightedPool[randomIndex];
        }

        function displayQuestion() {
            const word = words[currentWordIndex];
            // Randomly choose to show kanji or kana/caraBaca as the question
            const showKanji = Math.random() > 0.5 && word.kanji;

            if (showKanji) {
                questionText.textContent = word.kanji;
                questionType.textContent = 'What is the reading and meaning?';
            } else {
                questionText.textContent = word.kana || word.caraBaca;
                questionType.textContent = 'What is the kanji and meaning?';
            }
            
            answerCaraBaca.textContent = word.caraBaca;
            answerArti.textContent = word.arti;
        }

        function flipCard() {
            card.classList.add('is-flipped');
            questionButtons.classList.add('hidden');
            questionButtons.classList.remove('flex');
            answerButtons.classList.remove('hidden');
            answerButtons.classList.add('grid');
        }

        function handleScore(score) {
            questionsAnswered++;
            questionCounter++;
            
            if (score === 1) {
                perfectCount++;
            }

            // Update last 100 scores
            last100Scores.push(score);
            if (last100Scores.length > 100) {
                last100Scores.shift(); // Remove the oldest score
            }

            // Update word history and mastery
            const word = words[currentWordIndex];
            word.history.push(score);
            if (word.history.length > 5) {
                word.history.shift();
            }

            // Check for mastery: last 5 scores are all 1
            if (word.history.length === 5 && word.history.every(s => s === 1)) {
                word.mastery = 2; // Mastered
            } else {
                word.mastery = 1; // Learning
            }

            updateStats();

            if (questionCounter % 5 === 0) {
                showEncouragement();
            }
            
            nextQuestion();
        }

        // --- UI Updates ---
        function updateStats() {
            // Perfect score
            const perfectPercentage = questionsAnswered > 0 ? Math.round((perfectCount / questionsAnswered) * 100) : 0;
            document.getElementById('perfect-score').textContent = `${perfectPercentage}%`;

            // Last 100 score
            const last100Total = last100Scores.reduce((sum, score) => sum + score, 0);
            document.getElementById('last100-score').textContent = last100Total.toFixed(1);

            // Mastered count
            const masteredCount = words.filter(w => w.mastery === 2).length;
            document.getElementById('mastered-score').textContent = `${masteredCount}/${words.length}`;
        }

        function showEncouragement() {
            const popup = document.getElementById('encouragement-popup');
            const text = document.getElementById('encouragement-text');
            const message = encouragementMessages[Math.floor(Math.random() * encouragementMessages.length)];
            
            text.textContent = message;
            popup.classList.remove('hidden');

            setTimeout(() => {
                popup.classList.add('hidden');
            }, 3000);
        }

        // --- Start the game ---
        document.addEventListener('DOMContentLoaded', init);

    </script>
</body>
</html>

